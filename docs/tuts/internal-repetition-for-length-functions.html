
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Internal repetition for length functions</title>
    <link rel="icon" href="../IIScLogo.jpg">

    <!-- Bootstrap -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">
   <link href="../css/katex.min.css" rel="stylesheet">
   <link href="../css/main.css" rel="stylesheet">


    <link rel="stylesheet" href="../css/zenburn.css">
    <script src="../js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

   <script src="../js/ace.js"></script>
   <script src="../js/katex.min.js"></script>

    
<!-- mathjax config similar to math.stackexchange -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
jax: ["input/TeX", "output/HTML-CSS"],
tex2jax: {
  inlineMath: [ ['$', '$'] ],
  displayMath: [ ['$$', '$$']],
  processEscapes: true,
  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
},
messageStyle: "none",
"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
});
</script>
<script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
       </script>
    
  </head>

   
<body>
<nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <span class="navbar-brand">ProvingGround</span>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav" id="left-nav">
            <li><a href="../index.html">Docs Home</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                Tutorials (notes)<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="../tuts/hott.html">HoTT</a></li><li><a href="../tuts/left-and-right-identities.html">Left and Right Identities</a></li><li><a href="../tuts/internal-repetition-for-length-functions.html">Internal repetition for length functions</a></li><li><a href="../tuts/inductive-types.html">Inductive Types</a></li><li><a href="../tuts/scalarep.html">ScalaRep</a></li><li><a href="../tuts/symbolic-algebra.html">Symbolic algebra</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                Posts<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="../posts/computer-assistance-in-homogenous-length-functions.html">2018-1-14-Computer assistance in Homogenous length functions</a></li><li><a href="../posts/tuning-with-tensorflow.html">2017-12-12-Tuning with Tensorflow</a></li><li><a href="../posts/stalling-in-the-lean-import---the-problem-case..html">2017-12-7-Stalling in the lean import - the problem case.</a></li><li><a href="../posts/lean-import-and-propositions.html">2017-12-6-Lean Import and Propositions</a></li><li><a href="../posts/levels-of-parsimony,-as-seen-from-logic-runs.html">2017-11-2-Levels of parsimony, as seen from Logic runs</a></li><li><a href="../posts/improvements-to-searching-and--exploration.html">2017-10-31-Improvements to searching and  exploration</a></li><li><a href="../posts/logic-and-modus-ponens.html">2017-10-25-Logic and Modus Ponens</a></li><li><a href="../posts/prover-components-and-identities-in-a-monoid.html">2017-10-20-Prover Components and Identities in a Monoid</a></li><li><a href="../posts/on-import-from-lean-export-format.html">2017-10-17-On import from Lean Export format</a></li><li><a href="../posts/&quot;quasi-literate-programming&quot;.html">2014-12-31-&quot;Quasi-literate programming&quot;</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
                Notebooks<span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="../notes/HoTT.html" target="_blank">HoTT</a></li><li><a href="../notes/MonoidProof.html" target="_blank">MonoidProof</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li> <a href="../scaladoc/provingground/index.html" target="_blank">ScalaDocs</a></li>
            <li> <a href="https://github.com/siddhartha-gadgil/ProvingGround" target="_blank">
              <img src="../GitHub-Mark-Light-32px.png" alt="Github"></img> </a> </li>



          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>
<div class="container">

<h1 class="text-center">Internal repetition for length functions</h1>

<div class="text-justify">
<p>We formalize (in code) the combinatorial group theory part of the <em>spltting lemma</em> of the paper <a href="https://arxiv.org/abs/1801.03908">Homogenous length functions on Groups</a>. This is based on an implementation (in <em>scala</em>) of a large part of Homotopy type theory equipped with symbolic algebra in this project.</p>
<h2>The statement</h2>
<p>Assume we are given the following:</p>
<ul>
<li>A group $G$.</li>
<li>A (length) function $l: G \to \mathbb{Q}$ such that
<ul>
<li>For $g, h \in G$, $l(gh) \leq l(g) + l(h)$,</li>
<li>For $g, h\in G$, $l(ghg^{-1}) = l(g$).</li>
</ul>
</li>
<li>Elements $x, y, z, w \in G$ such that
<ul>
<li>$x \sim yw$ (here $\sim$ means conjugate in $G$),</li>
<li>$x \sim zw^{-1}$.</li>
</ul>
</li>
</ul>
<p>Then we have the following:</p>
<p><strong>Theorem:</strong> There exists a constant $A\in\mathbb{Q}$ so that for $n \in \mathbb{N}$,</p>
<p>$$l(x^{2n}) \leq n(l(y) + l(z)) +A.$$</p>
<p>In the above paper, homogeneity is used to deduce a bound for $l(x)$, and on taking the limit we get $l(x) \leq \frac{l(y) + l(z)}{2}$.</p>
<h2>Preliminaries</h2>
<p>We start with some imports. This is a bit ugly due to avoiding variable name collisions.</p>
<pre><code class="language-scala">import provingground._, HoTT._

import scalahott._, andrewscurtis.FreeGroups._
import spire.implicits._
import NatRing.{ x=&gt;_,  Literal =&gt; nat, _}, QField.{w =&gt; _, x =&gt;_, y=&gt;_, z=&gt;_, Literal =&gt; rat, _}, FreeGroup.{Literal =&gt; elem, _}
import Theorems.{PowerDistributive, ConjPower}
</code></pre>
<h2>The Setup</h2>
<p>We introduce terms for the length function $l$, as well as <em>witnesses</em> for the assumptions on $l$.</p>
<pre><code class="language-scala">val l = &quot;l&quot; :: FreeGroup -&gt;: QTyp
// l: Func[RepTerm[Word], RepTerm[spire.math.Rational]] = l

val g = &quot;g&quot; :: FreeGroup
// g: RepTerm[Word] = g
val h = &quot;h&quot; :: FreeGroup
// h: RepTerm[Word] = h
val n = &quot;n&quot; :: NatTyp
// n: RepTerm[spire.math.SafeLong] = n
</code></pre>
<pre><code class="language-scala">val triang =
  &quot;triangle-inequality&quot; :: (
    g ~&gt;: (h ~&gt;: (
      (leq(l(g |+| h))(l(g) + l(h)))
    ))
  )
// triang: FuncLike[RepTerm[Word], FuncLike[RepTerm[Word], PosWit]] = triangle-inequality
</code></pre>
<pre><code class="language-scala">val conjInv =
  &quot;conjugacy-invariance&quot; :: (
    g ~&gt;: (
      h ~&gt;: (
        (l(h) =:= (l(g |+| h |+| g.inverse)))
      )
    )
  )
// conjInv: FuncLike[RepTerm[Word], FuncLike[RepTerm[Word], Equality[RepTerm[spire.math.Rational]]]] = conjugacy-invariance
</code></pre>
<p>Next, we introduce variables for $x, y, z, s, t \in G$, where $s, t \in G$ are the elements so that the conjugacies $x \sim wy$ and $x \sim zw^{-1}$ are given by the equations  $x = swys^{-1}$ and $x = tzw^{-1}t^{-1}$.</p>
<pre><code class="language-scala">val w = &quot;w&quot; :: FreeGroup
// w: RepTerm[Word] = w
val y = &quot;y&quot; :: FreeGroup
// y: RepTerm[Word] = y
val z = &quot;z&quot; :: FreeGroup
// z: RepTerm[Word] = z
val s = &quot;s&quot; :: FreeGroup
// s: RepTerm[Word] = s
val t = &quot;t&quot; :: FreeGroup
// t: RepTerm[Word] = t
</code></pre>
<p>So far these are all independent. We shall introduce terms as witnesses for the above equations later, as we first prove a lemma not involving $x$.</p>
<h2>Statement of lemma</h2>
<p>The main internal repetition trick is captured the bound</p>
<p>$$l((wy)^ns^{-1}t(zw^{-1})^n)\leq n(l(y) + l(z)) + l(s^{-1}) + l(t).$$</p>
<p>We define $c(n) = (wy)^ns^{-1}t(zw^{-1})^n$ and $f(n) = n(l(y) + l(z)) + l(s^{-1}) + l(t)$, so the inequality is $l(c(n))\leq(f(n))$. We encode this  below as the <em>main lemma</em>.</p>
<pre><code class="language-scala">val wy = w |+| y
// wy: FreeGroup.LocalTerm = (&lt;function1&gt;) (y)
val zwbar = z |+| w.inverse
// zwbar: FreeGroup.LocalTerm = (&lt;function1&gt;) ((inv) (w))
val wyn = FreeGroup.power(wy)(n)
// wyn: RepTerm[Word] = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n)
val zwbarn = FreeGroup.power(zwbar)(n)
// zwbarn: RepTerm[Word] = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)
</code></pre>
<pre><code class="language-scala">val c = n :-&gt; (wyn |+| s.inverse |+| t |+| zwbarn) // this is the function we have to bound.
// c: Func[RepTerm[spire.math.SafeLong], FreeGroup.LocalTerm] = (n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) // this is the function we have to bound.

val r = incl(QField)
// r: Func[NatRing.LocalTerm, QField.LocalTerm] = rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))

val f = n :-&gt; (l(s.inverse) + l(t) + ((l(y) + l(z)) * r(n) ) )
// f: Func[RepTerm[spire.math.SafeLong], QField.LocalTerm] = (n :  Nat.Typ) ↦ (((l) (t) + (l) ((inv) (s)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n))))
</code></pre>
<pre><code class="language-scala">val lemma = n :-&gt; (leq (l(c(n)) )(f(n) ) )
// lemma: Func[RepTerm[spire.math.SafeLong], Pos] = (n :  Nat.Typ) ↦ (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)))))
</code></pre>
<h2>Proving the lemma</h2>
<p>Let $d(n) = (wy)(wy)^ns^{-1}t(zw^{-1})^n(zw)$. Note that by definition $g^{n+1} = g^n g$, so we need to prove $d(n) = c(n+1)$.
We use $g^ng^m = g^{n+m}$ (proved in our code) to prove this. The proof is given by the term <code>dIsc</code>.</p>
<pre><code class="language-scala">val d = n :-&gt; (wy |+| wyn |+| s.inverse |+| t |+| zwbarn  |+| zwbar)
// d: Func[RepTerm[spire.math.SafeLong], FreeGroup.LocalTerm] = (n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))
val dIsc = FreeGroup.rm(s.inverse |+| t |+| zwbarn |+| zwbar) *: (PowerDistributive.pf(wy)(nat(1))(n))
// dIsc: Equality[FreeGroup.LocalTerm] = (ind{($opdbj :  FreeGroup) ↦ (($opdbk :  FreeGroup) ↦ ($opdbj = $opdbk))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($ooydw :  FreeGroup) ↦ (($ooydx :  FreeGroup) ↦ ($ooydw = $ooydx))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))
</code></pre>
<pre><code class="language-scala">assert(dIsc.typ == (d(n) =:= c(succ(n))))
</code></pre>
<p>Next, let $b(n) = y(wy)^ns^{-1}t(zw^{-1})^nz$ be the conjugacy-reduced form of $d(n)$. Using $d(n) = c(n+1)$ and conjugacy invariance, we show that $l(c(n+1)) = l(b(n))$. The term <code>bIsc</code> is the proof of <code>l(c(n+1)) = l(b(n))</code>.</p>
<pre><code class="language-scala">val b = n :-&gt; (y |+| wyn |+| s.inverse |+| t |+| zwbarn  |+| z)
// b: Func[RepTerm[spire.math.SafeLong], FreeGroup.LocalTerm] = (n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))
val lbIsld = conjInv(w)(y |+| c(n) |+| z)
// lbIsld: Equality[RepTerm[spire.math.Rational]] = ((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))
val bIsc = lbIsld &amp;&amp; (l *: dIsc)
// bIsc: Equality[RepTerm[spire.math.Rational]] = ((ind{($pilbl :  Q.Typ) ↦ (($pilbm :  Q.Typ) ↦ ($pilbl = $pilbm))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($opgwk :  Q.Typ) ↦ (($opgwl :  Q.Typ) ↦ ((_ : ($opgwk = $opgwl) :  $opgwk = $opgwl) ↦ (($opgwl = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) → ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))}(($opgwk :  Q.Typ) ↦ (($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) :  $opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ↦ ($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))) (((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) ((ind{($pildg :  FreeGroup) ↦ (($pildh :  FreeGroup) ↦ ($pildg = $pildh))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}{($opazp :  FreeGroup) ↦ (($opazq :  FreeGroup) ↦ ((_ : ($opazp = $opazq) :  $opazp = $opazq) ↦ ((l) ($opazp) = (l) ($opazq))))}(($opazp :  FreeGroup) ↦ (Refl(Q.Typ,(l) ($opazp))))) ((ind{($opdbj :  FreeGroup) ↦ (($opdbk :  FreeGroup) ↦ ($opdbj = $opdbk))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($ooydw :  FreeGroup) ↦ (($ooydx :  FreeGroup) ↦ ($ooydw = $ooydx))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))
</code></pre>
<pre><code class="language-scala">assert(bIsc.typ == (l(b(n)) =:= l(c(succ(n))) ))
</code></pre>
<p>With these preliminaries, we can prove the lemma by induction. First note the base case.</p>
<pre><code class="language-scala">val baseCase = triang(inv(s))(t) !: (lemma(0))
// baseCase: PosWit = ((triangle-inequality) ((inv) (s))) (t) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) (t))) + (l) ((inv) (s)) + (l) (t))))
</code></pre>
<p>The induction step takes more work.
We first assume the induction hypothesis.</p>
<pre><code class="language-scala">val hyp = &quot;hyp&quot; :: lemma(n)
// hyp: PosWit = hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))))
</code></pre>
<p>Next, we bound $l(b(n))$ (which we know is $l(c(n+ 1)))$ in terms of $l(c(n))$.</p>
<pre><code class="language-scala">val lbnBoundedlcnlylz = triang(y)(c(n)) + triang(y |+| c(n))(z)
// lbnBoundedlcnlylz: PosWitSum = PosWitSum(((triangle-inequality) (y)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (y) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) (z) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) (z)))))
</code></pre>
<pre><code class="language-scala">assert(lbnBoundedlcnlylz.typ == (leq(l(b(n)))(l(c(n)) + l(y) + l(z))))
</code></pre>
<p>Now, using the induction hypothesis, we get a bound on $l(b(n))$.</p>
<pre><code class="language-scala">val lbnBounded = lbnBoundedlcnlylz + hyp
// lbnBounded: PosWitSum = PosWitSum(PosWitSum(((triangle-inequality) (y)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (y) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) (z) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) (z))))),hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))))))
</code></pre>
<pre><code class="language-scala">assert(lbnBounded.typ == leq(l(b(n)) )(f(succ(n))) )
</code></pre>
<p>Next, we put together $l(c(n+1)) = l(b(n))$ and the bound on $l(b(n))$ to get the required bound on $l(c(n+1))$.</p>
<pre><code class="language-scala">val bnd = &quot;bound&quot; :: QField.LocalTyp
// bnd: RepTerm[spire.math.Rational] = bound
val cbnd = bIsc.lift(bnd :-&gt; (leq(bnd)(f(succ(n)) ) ))
// cbnd: Func[PosWit, PosWit] = (ind{($plclj :  Q.Typ) ↦ (($plclk :  Q.Typ) ↦ ($plclj = $plclk))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($oqmnb :  Q.Typ) ↦ (($oqmnc :  Q.Typ) ↦ ((_ : ($oqmnb = $oqmnc) :  $oqmnb = $oqmnc) ↦ ((Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (&lt;function1&gt;) ($oqmnb) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))) → (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ($oqmnc) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))))))}(($oqmnb :  Q.Typ) ↦ (($oxunf : (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))) :  Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))) ↦ ($oxunf : (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))))))) (((ind{($pilbl :  Q.Typ) ↦ (($pilbm :  Q.Typ) ↦ ($pilbl = $pilbm))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($opgwk :  Q.Typ) ↦ (($opgwl :  Q.Typ) ↦ ((_ : ($opgwk = $opgwl) :  $opgwk = $opgwl) ↦ (($opgwl = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) → ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))}(($opgwk :  Q.Typ) ↦ (($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) :  $opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ↦ ($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))) (((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) ((ind{($pildg :  FreeGroup) ↦ (($pildh :  FreeGroup) ↦ ($pildg = $pildh))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}{($opazp :  FreeGroup) ↦ (($opazq :  FreeGroup) ↦ ((_ : ($opazp = $opazq) :  $opazp = $opazq) ↦ ((l) ($opazp) = (l) ($opazq))))}(($opazp :  FreeGroup) ↦ (Refl(Q.Typ,(l) ($opazp))))) ((ind{($opdbj :  FreeGroup) ↦ (($opdbk :  FreeGroup) ↦ ($opdbj = $opdbk))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($ooydw :  FreeGroup) ↦ (($ooydx :  FreeGroup) ↦ ($ooydw = $ooydx))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))
val step = cbnd(lbnBounded)
// step: PosWit = ((ind{($plclj :  Q.Typ) ↦ (($plclk :  Q.Typ) ↦ ($plclj = $plclk))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($oqmnb :  Q.Typ) ↦ (($oqmnc :  Q.Typ) ↦ ((_ : ($oqmnb = $oqmnc) :  $oqmnb = $oqmnc) ↦ ((Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (&lt;function1&gt;) ($oqmnb) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))) → (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ($oqmnc) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))))))}(($oqmnb :  Q.Typ) ↦ (($oxunf : (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))) :  Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))) ↦ ($oxunf : (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z)))))))) (((ind{($pilbl :  Q.Typ) ↦ (($pilbm :  Q.Typ) ↦ ($pilbl = $pilbm))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($opgwk :  Q.Typ) ↦ (($opgwl :  Q.Typ) ↦ ((_ : ($opgwk = $opgwl) :  $opgwk = $opgwl) ↦ (($opgwl = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) → ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))}(($opgwk :  Q.Typ) ↦ (($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) :  $opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ↦ ($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))) (((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) ((ind{($pildg :  FreeGroup) ↦ (($pildh :  FreeGroup) ↦ ($pildg = $pildh))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}{($opazp :  FreeGroup) ↦ (($opazq :  FreeGroup) ↦ ((_ : ($opazp = $opazq) :  $opazp = $opazq) ↦ ((l) ($opazp) = (l) ($opazq))))}(($opazp :  FreeGroup) ↦ (Refl(Q.Typ,(l) ($opazp))))) ((ind{($opdbj :  FreeGroup) ↦ (($opdbk :  FreeGroup) ↦ ($opdbj = $opdbk))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($ooydw :  FreeGroup) ↦ (($ooydx :  FreeGroup) ↦ ($ooydw = $ooydx))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) (PosWitSum(PosWitSum(((triangle-inequality) (y)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (y) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) (z) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) (z))))),hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))))))) : (Pos(((l) (y) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (z) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))
</code></pre>
<pre><code class="language-scala">assert(step.typ == lemma(succ(n)))
</code></pre>
<p>Finally, the lemma is proved by induction.</p>
<pre><code class="language-scala">val lemmaProof = Induc(lemma, baseCase, n :~&gt; (hyp :-&gt; step))
// lemmaProof: Induc[PosWit] = ind(Nat.Typ)((n :  Nat.Typ) ↦ (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n))))))(((triangle-inequality) ((inv) (s))) (t) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) (t))) + (l) ((inv) (s)) + (l) (t)))))((n :  Nat.Typ) ↦ ((hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))) :  Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))) ↦ (((ind{($qqhnb :  Q.Typ) ↦ (($qqhnc :  Q.Typ) ↦ ($qqhnb = $qqhnc))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($oqmnb :  Q.Typ) ↦ (($oqmnc :  Q.Typ) ↦ ((_ : ($oqmnb = $oqmnc) :  $oqmnb = $oqmnc) ↦ ((Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (&lt;function1&gt;) ($oqmnb) + (l) (t) + (l) (z)))) → (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ($oqmnc) + (l) ((inv) (s)) + (l) (t) + (l) (z)))))))}(($oqmnb :  Q.Typ) ↦ (($oxunf : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))) :  Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))) ↦ ($oxunf : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))))))) (((ind{($qqhne :  Q.Typ) ↦ (($qqhnf :  Q.Typ) ↦ ($qqhne = $qqhnf))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($opgwk :  Q.Typ) ↦ (($opgwl :  Q.Typ) ↦ ((_ : ($opgwk = $opgwl) :  $opgwk = $opgwl) ↦ (($opgwl = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) → ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))}(($opgwk :  Q.Typ) ↦ (($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) :  $opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ↦ ($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))) (((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) ((ind{($qqhnh :  FreeGroup) ↦ (($qqhni :  FreeGroup) ↦ ($qqhnh = $qqhni))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}{($opazp :  FreeGroup) ↦ (($opazq :  FreeGroup) ↦ ((_ : ($opazp = $opazq) :  $opazp = $opazq) ↦ ((l) ($opazp) = (l) ($opazq))))}(($opazp :  FreeGroup) ↦ (Refl(Q.Typ,(l) ($opazp))))) ((ind{($qqhnk :  FreeGroup) ↦ (($qqhnl :  FreeGroup) ↦ ($qqhnk = $qqhnl))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($qqhnn :  FreeGroup) ↦ (($qqhno :  FreeGroup) ↦ ($qqhnn = $qqhno))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) (PosWitSum(PosWitSum(((triangle-inequality) (y)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (y) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) (z) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) (z))))),hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))))) : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (l) (z) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))))))))
</code></pre>
<pre><code class="language-scala">assert(lemmaProof.typ == (n ~&gt;: (lemma(n))) )
</code></pre>
<h2>Rest of the proof of the theorem</h2>
<p>Some work remains, essentially to use symbolic algebra for equations such as $x^{2n} = x^nx^n$
and to put together equations and inequalities. We introduce terms witnessing the hypotheses $x=swys^{-1}$ and $x=tzw^{-1}t^{-1}$</p>
<pre><code class="language-scala">val x = &quot;x&quot; :: FreeGroup
// x: RepTerm[Word] = x
// val g = &quot;g&quot; :: FreeGroup
val pown = g :-&gt; FreeGroup.power(g)(n)
// pown: Func[RepTerm[Word], RepTerm[Word]] = (g :  FreeGroup) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (g))))) (n))
</code></pre>
<pre><code class="language-scala">val c1 = &quot;x ~ wy&quot; :: (x =:= (s |+| w |+| y |+| s.inverse))
// c1: Equality[RepTerm[Word]] = x ~ wy : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))
val c2 = &quot;x ~ zw^{-1}&quot; :: (x =:= (t |+| z |+| w.inverse |+| t.inverse))
// c2: Equality[RepTerm[Word]] = x ~ zw^{-1} : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))
</code></pre>
<p>We deduce using a theorem (in our code) about powers of conjugates that $x^n = s(wy)^ns^{-1} = t(zw^{-1})^nt^{-1}$.</p>
<pre><code class="language-scala">val xnConjwyn = (pown *: c1) &amp;&amp; ConjPower.pf(s)(wy)(n)
// xnConjwyn: Equality[RepTerm[Word]] = ((ind{($pmack :  FreeGroup) ↦ (($pmacl :  FreeGroup) ↦ ($pmack = $pmacl))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))}{($plncl :  FreeGroup) ↦ (($plncm :  FreeGroup) ↦ ((_ : ($plncl = $plncm) :  $plncl = $plncm) ↦ (($plncm = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) → ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))}(($plncl :  FreeGroup) ↦ (($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  $plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))) ((ind{($plrvh :  FreeGroup) ↦ (($plrvi :  FreeGroup) ↦ ($plrvh = $plrvi))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))}{($plkhx :  FreeGroup) ↦ (($plkhy :  FreeGroup) ↦ ((_ : ($plkhx = $plkhy) :  $plkhx = $plkhy) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhy))))) (n))))}(($plkhx :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n))))) (x ~ wy : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ((ind{($pmacy :  FreeGroup) ↦ (($pmacz :  FreeGroup) ↦ ($pmacy = $pmacz))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))
val xnConjzwbarn= (pown *: c2) &amp;&amp; ConjPower.pf(t)(zwbar)(n)
// xnConjzwbarn: Equality[RepTerm[Word]] = ((ind{($pmfef :  FreeGroup) ↦ (($pmfeg :  FreeGroup) ↦ ($pmfef = $pmfeg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))}{($pltsk :  FreeGroup) ↦ (($pltsl :  FreeGroup) ↦ ((_ : ($pltsk = $pltsl) :  $pltsk = $pltsl) ↦ (($pltsl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) → ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))}(($pltsk :  FreeGroup) ↦ (($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  $pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) ((ind{($plylg :  FreeGroup) ↦ (($plylh :  FreeGroup) ↦ ($plylg = $plylh))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))}{($plsgt :  FreeGroup) ↦ (($plsgu :  FreeGroup) ↦ ((_ : ($plsgt = $plsgu) :  $plsgt = $plsgu) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgu))))) (n))))}(($plsgt :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n))))) (x ~ zw^{-1} : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ((ind{($pmfet :  FreeGroup) ↦ (($pmfeu :  FreeGroup) ↦ ($pmfet = $pmfeu))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))
</code></pre>
<pre><code class="language-scala">assert(xnConjwyn.typ == (pown(x) =:= (s |+| pown(wy)  |+| s.inverse  ) ) )
assert(xnConjzwbarn.typ == (pown(x) =:= (t |+| pown(zwbar)  |+| t.inverse  ) ) )
</code></pre>
<p>We use the above equations to show that $x^nx^n = s(wy)^ns^{-1}t(zw^{-1})^nt^{-1}$.</p>
<pre><code class="language-scala">val t1 = s |+| pown(wy)  |+| s.inverse
// t1: FreeGroup.LocalTerm = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))
val t2 = t |+| pown(zwbar)  |+| t.inverse
// t2: FreeGroup.LocalTerm = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))
</code></pre>
<pre><code class="language-scala">val xnxnExpr = (FreeGroup.rm(pown(x)) *: xnConjwyn) &amp;&amp; (FreeGroup.lm(t1) *: xnConjzwbarn)
// xnxnExpr: Equality[FreeGroup.LocalTerm] = ((ind{($pnjly :  FreeGroup) ↦ (($pnjlz :  FreeGroup) ↦ ($pnjly = $pnjlz))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))}{($pmipv :  FreeGroup) ↦ (($pmipw :  FreeGroup) ↦ ((_ : ($pmipv = $pmipw) :  $pmipv = $pmipw) ↦ (($pmipw = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) → ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))}(($pmipv :  FreeGroup) ↦ (($pmjsb : ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) :  $pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) ↦ ($pmjsb : ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))) ((ind{($pmnmf :  FreeGroup) ↦ (($pmnmg :  FreeGroup) ↦ ($pmnmf = $pmnmg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($plyxa :  FreeGroup) ↦ (($plyxb :  FreeGroup) ↦ ((_ : ($plyxa = $plyxb) :  $plyxa = $plyxb) ↦ ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))}(($plyxa :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))) (((ind{($pmack :  FreeGroup) ↦ (($pmacl :  FreeGroup) ↦ ($pmack = $pmacl))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))}{($plncl :  FreeGroup) ↦ (($plncm :  FreeGroup) ↦ ((_ : ($plncl = $plncm) :  $plncl = $plncm) ↦ (($plncm = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) → ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))}(($plncl :  FreeGroup) ↦ (($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  $plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))) ((ind{($plrvh :  FreeGroup) ↦ (($plrvi :  FreeGroup) ↦ ($plrvh = $plrvi))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))}{($plkhx :  FreeGroup) ↦ (($plkhy :  FreeGroup) ↦ ((_ : ($plkhx = $plkhy) :  $plkhx = $plkhy) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhy))))) (n))))}(($plkhx :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n))))) (x ~ wy : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ((ind{($pmacy :  FreeGroup) ↦ (($pmacz :  FreeGroup) ↦ ($pmacy = $pmacz))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))))))) ((ind{($pnjnh :  FreeGroup) ↦ (($pnjni :  FreeGroup) ↦ ($pnjnh = $pnjni))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pmdsb :  FreeGroup) ↦ (($pmdsc :  FreeGroup) ↦ ((_ : ($pmdsb = $pmdsc) :  $pmdsb = $pmdsc) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsb))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsc))))))}(($pmdsb :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsb))))))) (((ind{($pmfef :  FreeGroup) ↦ (($pmfeg :  FreeGroup) ↦ ($pmfef = $pmfeg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))}{($pltsk :  FreeGroup) ↦ (($pltsl :  FreeGroup) ↦ ((_ : ($pltsk = $pltsl) :  $pltsk = $pltsl) ↦ (($pltsl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) → ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))}(($pltsk :  FreeGroup) ↦ (($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  $pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) ((ind{($plylg :  FreeGroup) ↦ (($plylh :  FreeGroup) ↦ ($plylg = $plylh))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))}{($plsgt :  FreeGroup) ↦ (($plsgu :  FreeGroup) ↦ ((_ : ($plsgt = $plsgu) :  $plsgt = $plsgu) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgu))))) (n))))}(($plsgt :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n))))) (x ~ zw^{-1} : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ((ind{($pmfet :  FreeGroup) ↦ (($pmfeu :  FreeGroup) ↦ ($pmfet = $pmfeu))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))
</code></pre>
<pre><code class="language-scala">assert(xnxnExpr.typ == ((pown(x) |+| pown(x)) =:= (t1 |+| t2 )   ))
</code></pre>
<p>Using $x^nx^n = x^{2n}$, we get the formula $x^{2n} = s(wy)^ns^{-1}t(zw^{-1})^nt^{-1}$.</p>
<pre><code class="language-scala">val x2nExpr =PowerDistributive.pf(x)(n)(n).sym &amp;&amp; xnxnExpr
// x2nExpr: Equality[FreeGroup.LocalTerm] = ((ind{($pnjlg :  FreeGroup) ↦ (($pnjlh :  FreeGroup) ↦ ($pnjlg = $pnjlh))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))}{($pmyez :  FreeGroup) ↦ (($pmyfa :  FreeGroup) ↦ ((_ : ($pmyez = $pmyfa) :  $pmyez = $pmyfa) ↦ (($pmyfa = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) → ($pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))}(($pmyez :  FreeGroup) ↦ (($pmzhf : ($pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) :  $pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) ↦ ($pmzhf : ($pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))) ((ind{($pncyd :  FreeGroup) ↦ (($pncye :  FreeGroup) ↦ ($pncyd = $pncye))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))}{($pmxhw :  FreeGroup) ↦ (($pmxhx :  FreeGroup) ↦ ((_ : ($pmxhw = $pmxhx) :  $pmxhw = $pmxhx) ↦ ($pmxhx = $pmxhw)))}(($pmxhw :  FreeGroup) ↦ (Refl(FreeGroup,$pmxhw)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n))))(Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n))) :  (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n))) ↦ ((ind{($pmxvn :  FreeGroup) ↦ (($pmxvo :  FreeGroup) ↦ ($pmxvn = $pmxvo))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) (x) = (&lt;function1&gt;) (x))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) (x))))) (hyp : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) (x)) = (&lt;function1&gt;) (x)))))) (n) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)) = (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))))) (((ind{($pnjly :  FreeGroup) ↦ (($pnjlz :  FreeGroup) ↦ ($pnjly = $pnjlz))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))}{($pmipv :  FreeGroup) ↦ (($pmipw :  FreeGroup) ↦ ((_ : ($pmipv = $pmipw) :  $pmipv = $pmipw) ↦ (($pmipw = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) → ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))}(($pmipv :  FreeGroup) ↦ (($pmjsb : ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) :  $pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) ↦ ($pmjsb : ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))) ((ind{($pmnmf :  FreeGroup) ↦ (($pmnmg :  FreeGroup) ↦ ($pmnmf = $pmnmg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($plyxa :  FreeGroup) ↦ (($plyxb :  FreeGroup) ↦ ((_ : ($plyxa = $plyxb) :  $plyxa = $plyxb) ↦ ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))}(($plyxa :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))) (((ind{($pmack :  FreeGroup) ↦ (($pmacl :  FreeGroup) ↦ ($pmack = $pmacl))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))}{($plncl :  FreeGroup) ↦ (($plncm :  FreeGroup) ↦ ((_ : ($plncl = $plncm) :  $plncl = $plncm) ↦ (($plncm = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) → ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))}(($plncl :  FreeGroup) ↦ (($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  $plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))) ((ind{($plrvh :  FreeGroup) ↦ (($plrvi :  FreeGroup) ↦ ($plrvh = $plrvi))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))}{($plkhx :  FreeGroup) ↦ (($plkhy :  FreeGroup) ↦ ((_ : ($plkhx = $plkhy) :  $plkhx = $plkhy) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhy))))) (n))))}(($plkhx :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n))))) (x ~ wy : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ((ind{($pmacy :  FreeGroup) ↦ (($pmacz :  FreeGroup) ↦ ($pmacy = $pmacz))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))))))) ((ind{($pnjnh :  FreeGroup) ↦ (($pnjni :  FreeGroup) ↦ ($pnjnh = $pnjni))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pmdsb :  FreeGroup) ↦ (($pmdsc :  FreeGroup) ↦ ((_ : ($pmdsb = $pmdsc) :  $pmdsb = $pmdsc) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsb))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsc))))))}(($pmdsb :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsb))))))) (((ind{($pmfef :  FreeGroup) ↦ (($pmfeg :  FreeGroup) ↦ ($pmfef = $pmfeg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))}{($pltsk :  FreeGroup) ↦ (($pltsl :  FreeGroup) ↦ ((_ : ($pltsk = $pltsl) :  $pltsk = $pltsl) ↦ (($pltsl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) → ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))}(($pltsk :  FreeGroup) ↦ (($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  $pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) ((ind{($plylg :  FreeGroup) ↦ (($plylh :  FreeGroup) ↦ ($plylg = $plylh))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))}{($plsgt :  FreeGroup) ↦ (($plsgu :  FreeGroup) ↦ ((_ : ($plsgt = $plsgu) :  $plsgt = $plsgu) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgu))))) (n))))}(($plsgt :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n))))) (x ~ zw^{-1} : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ((ind{($pmfet :  FreeGroup) ↦ (($pmfeu :  FreeGroup) ↦ ($pmfet = $pmfeu))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))
</code></pre>
<pre><code class="language-scala">assert(x2nExpr.typ == (FreeGroup.power(x)(NatRing.prod(n)(nat(2))) =:= (s |+| c(n) |+| t.inverse)))
</code></pre>
<p>We now bound the length of the right hand side $s(wy)^ns^{-1}t(zw^{-1})^nt^{-1}$.</p>
<pre><code class="language-scala">val thmBound = f(n) + l(s) + l(t.inverse)
// thmBound: QField.LocalTerm = ((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s))
</code></pre>
<pre><code class="language-scala">val exprBound = lemmaProof(n) + triang(s)(c(n)) + triang(s |+| c(n))(t.inverse)
// exprBound: PosWitSum = PosWitSum(PosWitSum((ind(Nat.Typ)((n :  Nat.Typ) ↦ (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n))))))(((triangle-inequality) ((inv) (s))) (t) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) (t))) + (l) ((inv) (s)) + (l) (t)))))((n :  Nat.Typ) ↦ ((hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))) :  Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))) ↦ (((ind{($qqhnb :  Q.Typ) ↦ (($qqhnc :  Q.Typ) ↦ ($qqhnb = $qqhnc))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($oqmnb :  Q.Typ) ↦ (($oqmnc :  Q.Typ) ↦ ((_ : ($oqmnb = $oqmnc) :  $oqmnb = $oqmnc) ↦ ((Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (&lt;function1&gt;) ($oqmnb) + (l) (t) + (l) (z)))) → (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ($oqmnc) + (l) ((inv) (s)) + (l) (t) + (l) (z)))))))}(($oqmnb :  Q.Typ) ↦ (($oxunf : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))) :  Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))) ↦ ($oxunf : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))))))) (((ind{($qqhne :  Q.Typ) ↦ (($qqhnf :  Q.Typ) ↦ ($qqhne = $qqhnf))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($opgwk :  Q.Typ) ↦ (($opgwl :  Q.Typ) ↦ ((_ : ($opgwk = $opgwl) :  $opgwk = $opgwl) ↦ (($opgwl = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) → ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))}(($opgwk :  Q.Typ) ↦ (($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) :  $opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ↦ ($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))) (((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) ((ind{($qqhnh :  FreeGroup) ↦ (($qqhni :  FreeGroup) ↦ ($qqhnh = $qqhni))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}{($opazp :  FreeGroup) ↦ (($opazq :  FreeGroup) ↦ ((_ : ($opazp = $opazq) :  $opazp = $opazq) ↦ ((l) ($opazp) = (l) ($opazq))))}(($opazp :  FreeGroup) ↦ (Refl(Q.Typ,(l) ($opazp))))) ((ind{($qqhnk :  FreeGroup) ↦ (($qqhnl :  FreeGroup) ↦ ($qqhnk = $qqhnl))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($qqhnn :  FreeGroup) ↦ (($qqhno :  FreeGroup) ↦ ($qqhnn = $qqhno))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) (PosWitSum(PosWitSum(((triangle-inequality) (y)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (y) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) (z) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) (z))))),hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))))) : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (l) (z) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))))))))) (n) : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))))),((triangle-inequality) (s)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (s) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) ((inv) (t)) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (t))))))
</code></pre>
<pre><code class="language-scala">assert(exprBound.typ == leq(l(s |+| c(n) |+| t.inverse ))(thmBound))
</code></pre>
<p>We easily deduce the bound on $l(x^{2n})$ to complete the proof.</p>
<pre><code class="language-scala">val thmProof = x2nExpr.sym.lift (g :-&gt; leq(l(g))(thmBound))(exprBound)
// thmProof: PosWit = ((ind{($qqhnq :  FreeGroup) ↦ (($qqhnr :  FreeGroup) ↦ ($qqhnq = $qqhnr))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))}{($pnuhy :  FreeGroup) ↦ (($pnuhz :  FreeGroup) ↦ ((_ : ($pnuhy = $pnuhz) :  $pnuhy = $pnuhz) ↦ ((Pos(((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ((l) ($pnuhy)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s)))) → (Pos(((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ($pnuhz)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s)))))))}(($pnuhy :  FreeGroup) ↦ (($pyzrs : (Pos(((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ($pnuhy)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s)))) :  Pos(((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ($pnuhy)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s)))) ↦ ($pyzrs : (Pos(((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ($pnuhy)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s)))))))) ((ind{($qpblv :  FreeGroup) ↦ (($qpblw :  FreeGroup) ↦ ($qpblv = $qpblw))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))}{($pnioa :  FreeGroup) ↦ (($pniob :  FreeGroup) ↦ ((_ : ($pnioa = $pniob) :  $pnioa = $pniob) ↦ ($pniob = $pnioa)))}(($pnioa :  FreeGroup) ↦ (Refl(FreeGroup,$pnioa)))) (((ind{($pnjlg :  FreeGroup) ↦ (($pnjlh :  FreeGroup) ↦ ($pnjlg = $pnjlh))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))}{($pmyez :  FreeGroup) ↦ (($pmyfa :  FreeGroup) ↦ ((_ : ($pmyez = $pmyfa) :  $pmyez = $pmyfa) ↦ (($pmyfa = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) → ($pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))}(($pmyez :  FreeGroup) ↦ (($pmzhf : ($pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) :  $pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) ↦ ($pmzhf : ($pmyez = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))) ((ind{($pncyd :  FreeGroup) ↦ (($pncye :  FreeGroup) ↦ ($pncyd = $pncye))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))}{($pmxhw :  FreeGroup) ↦ (($pmxhx :  FreeGroup) ↦ ((_ : ($pmxhw = $pmxhx) :  $pmxhw = $pmxhx) ↦ ($pmxhx = $pmxhw)))}(($pmxhw :  FreeGroup) ↦ (Refl(FreeGroup,$pmxhw)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n))))(Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n))) :  (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n))) ↦ ((ind{($pmxvn :  FreeGroup) ↦ (($pmxvo :  FreeGroup) ↦ ($pmxvn = $pmxvo))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) (x) = (&lt;function1&gt;) (x))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) (x))))) (hyp : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((n + n)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) (x)) = (&lt;function1&gt;) (x)))))) (n) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)) = (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))))) (((ind{($pnjly :  FreeGroup) ↦ (($pnjlz :  FreeGroup) ↦ ($pnjly = $pnjlz))((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))}{($pmipv :  FreeGroup) ↦ (($pmipw :  FreeGroup) ↦ ((_ : ($pmipv = $pmipw) :  $pmipv = $pmipw) ↦ (($pmipw = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) → ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))}(($pmipv :  FreeGroup) ↦ (($pmjsb : ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) :  $pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))) ↦ ($pmjsb : ($pmipv = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))))) ((ind{($pmnmf :  FreeGroup) ↦ (($pmnmg :  FreeGroup) ↦ ($pmnmf = $pmnmg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($plyxa :  FreeGroup) ↦ (($plyxb :  FreeGroup) ↦ ((_ : ($plyxa = $plyxb) :  $plyxa = $plyxb) ↦ ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))}(($plyxa :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))))) (((ind{($pmack :  FreeGroup) ↦ (($pmacl :  FreeGroup) ↦ ($pmack = $pmacl))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))}{($plncl :  FreeGroup) ↦ (($plncm :  FreeGroup) ↦ ((_ : ($plncl = $plncm) :  $plncl = $plncm) ↦ (($plncm = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) → ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))}(($plncl :  FreeGroup) ↦ (($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  $plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ($ploer : ($plncl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))) ((ind{($plrvh :  FreeGroup) ↦ (($plrvi :  FreeGroup) ↦ ($plrvh = $plrvi))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))}{($plkhx :  FreeGroup) ↦ (($plkhy :  FreeGroup) ↦ ((_ : ($plkhx = $plkhy) :  $plkhx = $plkhy) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhy))))) (n))))}(($plkhx :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plkhx))))) (n))))) (x ~ wy : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))) ↦ ((ind{($pmacy :  FreeGroup) ↦ (($pmacz :  FreeGroup) ↦ ($pmacy = $pmacz))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (s))))) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))))))) ((ind{($pnjnh :  FreeGroup) ↦ (($pnjni :  FreeGroup) ↦ ($pnjnh = $pnjni))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pmdsb :  FreeGroup) ↦ (($pmdsc :  FreeGroup) ↦ ((_ : ($pmdsb = $pmdsc) :  $pmdsb = $pmdsc) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsb))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsc))))))}(($pmdsb :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ($pmdsb))))))) (((ind{($pmfef :  FreeGroup) ↦ (($pmfeg :  FreeGroup) ↦ ($pmfef = $pmfeg))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))}{($pltsk :  FreeGroup) ↦ (($pltsl :  FreeGroup) ↦ ((_ : ($pltsk = $pltsl) :  $pltsk = $pltsl) ↦ (($pltsl = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) → ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))}(($pltsk :  FreeGroup) ↦ (($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  $pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ($pluuq : ($pltsk = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) ((ind{($plylg :  FreeGroup) ↦ (($plylh :  FreeGroup) ↦ ($plylg = $plylh))(x)((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))}{($plsgt :  FreeGroup) ↦ (($plsgu :  FreeGroup) ↦ ((_ : ($plsgt = $plsgu) :  $plsgt = $plsgu) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgu))))) (n))))}(($plsgt :  FreeGroup) ↦ (Refl(FreeGroup,(rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ($plsgt))))) (n))))) (x ~ zw^{-1} : (x = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n)))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))(Refl(FreeGroup,1))((n :  Nat.Typ) ↦ ((hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) :  (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))) ↦ ((ind{($pmfet :  FreeGroup) ↦ (($pmfeu :  FreeGroup) ↦ ($pmfet = $pmfeu))((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n))((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))}{($pllgu :  FreeGroup) ↦ (($pllgv :  FreeGroup) ↦ ((_ : ($pllgu = $pllgv) :  $pllgu = $pllgv) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))}(($pllgu :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (hyp : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))))) (n) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n) = (&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) : ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) : ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))) = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n))))) (PosWitSum(PosWitSum((ind(Nat.Typ)((n :  Nat.Typ) ↦ (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n))))))(((triangle-inequality) ((inv) (s))) (t) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) (t))) + (l) ((inv) (s)) + (l) (t)))))((n :  Nat.Typ) ↦ ((hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))) :  Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))) ↦ (((ind{($qqhnb :  Q.Typ) ↦ (($qqhnc :  Q.Typ) ↦ ($qqhnb = $qqhnc))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($oqmnb :  Q.Typ) ↦ (($oqmnc :  Q.Typ) ↦ ((_ : ($oqmnb = $oqmnc) :  $oqmnb = $oqmnc) ↦ ((Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (&lt;function1&gt;) ($oqmnb) + (l) (t) + (l) (z)))) → (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ($oqmnc) + (l) ((inv) (s)) + (l) (t) + (l) (z)))))))}(($oqmnb :  Q.Typ) ↦ (($oxunf : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))) :  Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))) ↦ ($oxunf : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (&lt;function1&gt;) ($oqmnb) + (l) (z)))))))) (((ind{($qqhne :  Q.Typ) ↦ (($qqhnf :  Q.Typ) ↦ ($qqhne = $qqhnf))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))))((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))}{($opgwk :  Q.Typ) ↦ (($opgwl :  Q.Typ) ↦ ((_ : ($opgwk = $opgwl) :  $opgwk = $opgwl) ↦ (($opgwl = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) → ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))}(($opgwk :  Q.Typ) ↦ (($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) :  $opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ↦ ($ophyq : ($opgwk = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))))) (((conjugacy-invariance) (w)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) ((ind{($qqhnh :  FreeGroup) ↦ (($qqhni :  FreeGroup) ↦ ($qqhnh = $qqhni))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}{($opazp :  FreeGroup) ↦ (($opazq :  FreeGroup) ↦ ((_ : ($opazp = $opazq) :  $opazp = $opazq) ↦ ((l) ($opazp) = (l) ($opazq))))}(($opazp :  FreeGroup) ↦ (Refl(Q.Typ,(l) ($opazp))))) ((ind{($qqhnk :  FreeGroup) ↦ (($qqhnl :  FreeGroup) ↦ ($qqhnk = $qqhnl))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oowbx :  FreeGroup) ↦ (($oowby :  FreeGroup) ↦ ((_ : ($oowbx = $oowby) :  $oowbx = $oowby) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))}(($oowbx :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) ((ind(Nat.Typ)((n :  Nat.Typ) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))))(Refl(FreeGroup,(&lt;function1&gt;) (y)))((n :  Nat.Typ) ↦ ((hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) :  (&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y))) ↦ ((ind{($qqhnn :  FreeGroup) ↦ (($qqhno :  FreeGroup) ↦ ($qqhnn = $qqhno))((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))))((&lt;function1&gt;) ((&lt;function1&gt;) (y)))}{($oousf :  FreeGroup) ↦ (($oousg :  FreeGroup) ↦ ((_ : ($oousf = $oousg) :  $oousf = $oousg) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))))}(($oousf :  FreeGroup) ↦ (Refl(FreeGroup,(&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (hyp : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (y))))))))) (n) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) (y)))))) (n))) = (&lt;function1&gt;) ((&lt;function1&gt;) (y)))) : ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))) = (&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))) : ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z)))))) = (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w)))))))))))) (PosWitSum(PosWitSum(((triangle-inequality) (y)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (y) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) (z) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) (z))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) (z))))),hyp : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (s)) + (l) (t)))))) : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (y) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + (l) (z) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))))))))))))) (n) : (Pos((((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))))),((triangle-inequality) (s)) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) + (l) (s) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))))),((triangle-inequality) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n))))))) ((inv) (t)) : (Pos(((&lt;function1&gt;) ((l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (t)))))))) + (l) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((&lt;function1&gt;) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) ((&lt;function1&gt;) ((inv) (w))))))) (n)))))) + (l) ((inv) (t))))))) : (Pos(((l) ((inv) (t)) + ((l) (y) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) ((inv) (s)) + (&lt;function1&gt;) ((l) ((rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n)))) + (l) (t) + ((l) (z) * (rec(Nat.Typ)(Q.Typ)(0)((_ :  Nat.Typ) ↦ ((f(n) :  Q.Typ) ↦ ((&lt;function1&gt;) (f(n)))))) (n)) + (l) (s))))
</code></pre>
<pre><code class="language-scala">val x2n = FreeGroup.power(x)(NatRing.prod(n)(nat(2)))
// x2n: RepTerm[Word] = (rec(Nat.Typ)(FreeGroup)(1)((_ :  Nat.Typ) ↦ ((f(n)(g) :  FreeGroup) ↦ ((&lt;function1&gt;) (x))))) ((&lt;function1&gt;) (n))
</code></pre>
<pre><code class="language-scala">assert(thmProof.typ == leq(l(x2n))(thmBound ))
</code></pre>
<h4>git commit hash when running tutorial: aa8a358c9146f117ffcb9b6d42cb98140ffcd36e</h4>


</div>
</div>

<div class="container-fluid">
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <p>&nbsp;</p>
  <div class="footer navbar-fixed-bottom bg-primary">
    <h4>
    &nbsp;Developed by:
    &nbsp;<a href="http://math.iisc.ac.in/~gadgil" target="_blank">&nbsp; Siddhartha Gadgil</a>

  </h4>

  </div>
</div>
<script type="text/javascript" src="../js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.min.js"></script>
<script type="text/javascript" src="../js/provingground.js"></script>
<script>
  provingground.main()
</script>
   
</body>
</html>
   